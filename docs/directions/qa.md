# QA Direction

- **Owner:** QA Agent
- **Effective:** 2025-10-18
- **Version:** 2.2

## Objective

Current Issue: #114

Guarantee production confidence by running targeted Playwright, accessibility, and regression suites with documented evidence and blocker tracking.

## Tasks

### Assigned Tasks — Current Sprint (Generated by Manager)

0. **Resolve Current Blockers First**

- **Intent:** Clear existing P1 blockers identified in feedback/audit.
- **Done-When:** P1 blockers resolved or converted to Issues with ETA & owner.
- **Evidence:** Linked Issues/PRs, passing tests, logs/screens.
- **Priority:** P1
- **Source:** audit

1. **Finalize two-tier QA plan & coordinate suite sequencing**

- **Intent:** Capture the Tier A/B plan in `/tmp/qa_plan.json`, document command sequencing in feedback, and identify any prerequisites (e.g., approvals/idea specs) needed before re-running suites.
- **Done-When:** Plan file lists Tier A/B molecules with owners/status, `feedback/qa/2025-10-18.md` documents pending prerequisites, blockers have owners/ETAs.
- **Evidence:** Plan snapshot, feedback excerpt, Issue comments for escalations.
- **Dependencies:** Manager/Engineering/Integrations for approvals/idea specs reinstatement, DevOps for CI stability.
- **Priority:** P1
- **Source:** feedback

2. **Execute Tier A suites & compile deliverables**

- **Intent:** Run Tier A suites defined in `docs/tests/qa_scope_packet.md` (accessibility, targeted Playwright, contract tests) and assemble required deliverables (fix log, coverage delta, a11y smoke, security/deps, next risks).
- **Done-When:** Each suite produces pass/fail artifacts under `artifacts/qa/<date>`, deliverables summarized in feedback, blockers escalated with Issue IDs and proposed remedies. If waiting on approvals/idea specs, note dependencies, then resume suites once upstream fixes land.
- **Evidence:** Playwright traces or Chrome DevTools accessibility reports, Vitest logs, fix/coverage summaries in feedback.
- **Dependencies:** DevOps for CI stability, Engineer/Integrations/Inventory for fixtures/migrations, Support for webhook retry validation.
- **Priority:** P1
- **Source:** feedback

3. **Convert QA automation to Codex planning loop**

- **Intent:** Replace Auggie-only molecules with Codex-native planning so Tier A/B suites can be orchestrated without credit limits.
- **Done-When:** `/tmp/qa_plan.json` regenerated via Codex `/plan`, QA automation scripts updated (or Issues filed) to run without Auggie stubagents, feedback documents new launch instructions and confirms MCP usage for Chrome DevTools/Context7, blocker escalations include proposed Codex molecules.
- **Evidence:** Updated plan file, script diffs or Issue links, feedback excerpt, artifact capturing Codex plan execution.
- **Dependencies:** Manager for approval of new launch prompt, DevOps for CI integration, Engineer for missing fixtures if uncovered.
- **Priority:** P1
- **Source:** audit

**Reminder:** GitHub Actions billing has been confirmed healthy. If CI commands fail, log the exact error/output instead of reporting a billing blocker.

4. **Implement `qa:app-usability` smoke harness (P1)**

- **Intent:** Provide a single entrypoint to smoke critical app flows after a build. Exercise approvals drawer load, analytics tiles render, SEO API mock endpoint, and Chatwoot draft route. Write output and exit code, always logging to `artifacts/manager/<date>/startup_app_usability.log` when invoked during manager startup.
- **Done-When:**
  - `npm run qa:app-usability` exists and runs `node scripts/ops/qa-app-usability.mjs`.
  - The script loads the built app (server/index.js) or uses Playwright to visit key routes, captures basic console errors, and reports PASS/FAIL.
  - Artifacts: `artifacts/qa/<date>/app_usability/*.log` and `artifacts/manager/<date>/startup_app_usability.log` updated.
  - Feedback entry `feedback/qa/<YYYY-MM-DD>.md` includes at least three remediation attempts if the smoke fails, with exact commands and MCP transcripts (Chrome DevTools MCP for errors; Context7 for route discovery).
- **Evidence:** Log files under `artifacts/qa/<date>/app_usability/`, `artifacts/manager/<date>/startup_app_usability.log`, and a plan snapshot `/tmp/qa_plan.json`.
- **Dependencies:** Engineer (ensures current build), DevOps (runner wiring in CI), Manager (startup integration).
- **Priority:** P1
- **Source:** manager startup gate

**Autonomous Execution Protocol**

- Once Task 0 (P0 blockers) is documented in `feedback/qa/2025-10-18.md`, continue with P1 → P2 → P3 tasks autonomously without CEO intervention.
- Before each molecule, refresh `/tmp/qa_plan.json` (or `/plan`) and capture MCP transcripts + checksums (Chrome DevTools accessibility dumps, Supabase fixture checks, Context7 specs). Reference artifact paths in feedback—no MCP evidence → molecule invalid.
- If a suite is blocked, capture the failure output and at least **three remediation attempts** (commands + MCP transcripts), file the dependency with owner/ETA, and immediately pivot to another molecule (Codex plan conversion, alternate suite, documentation) so progress continues.
- Keep `/tmp/qa_plan.json` current with molecule progress and blockers, and log MCP artifacts in feedback.

Launch: "You are the qa agent execute @~/HotDash/hot-dash/docs/launch/agent_all_in_one.md" (Claude override when requested: `You are the qa agent execute @~/HotDash/hot-dash/docs/launch/qa_claude_code.md`)

**Finish-Line Checklist**

- Tests, lint, scan from Global DoD executed with logs linked in feedback.
- Issue/PR references Allowed paths, Fixes #, and rollback notes.
- Docs/directions updated; completed tasks archived per RULES.
- Evidence artifacts stored under `artifacts/` and cross-referenced in feedback.

## Constraints

- **Allowed Tools:** `bash`, `npm`, `npx`, `node`, `rg`, `jq`
- **Process:** Follow docs/OPERATING_MODEL.md (Signals→Learn pipeline); MCP usage is mandatory (Shopify Dev MCP, Context7, Supabase MCP, Knowledge MCP where applicable); log daily feedback per docs/RULES.md.
- **Touched Directories:** `tests/playwright/**`, `tests/e2e/**`, `docs/tests/**`, `feedback/qa/2025-10-18.md`
- **Budget:** time ≤ 60 minutes, tokens ≤ 140k, files ≤ 50 per PR
- **Guardrails:** No disabling tests without documented blocker; escalate failures immediately.

## Definition of Done

- [ ] QA scope packet published
- [ ] Playwright + accessibility suites executed with logs
- [ ] `npm run fmt` and `npm run lint`
- [ ] `npm run test:ci`
- [ ] `npm run scan`
- [ ] `npm run qa:app-usability` passes; if blocked, feedback shows ≥3 remediation attempts + owner/ETA
- [ ] Feedback entry updated with outcomes
- [ ] Contract test passes

## Contract Test

- **Command:** `npm run test:a11y`
- **Expectations:** Accessibility suite runs; failures documented with follow-up.

## Risk & Rollback

- **Risk Level:** High — Undetected regressions ship to production.
- **Rollback Plan:** Block release, work with Engineer to fix failing tests, rerun suite.
- **Monitoring:** Playwright reports, QA packet updates, approvals backlog.

## Links & References

- North Star: `docs/NORTH_STAR.md`
- Roadmap: `docs/roadmap.md`
- Feedback: `feedback/qa/2025-10-18.md`
- Specs / Runbooks: `docs/tests/qa_scope_packet.md`

## Change Log

- 2025-10-18: Version 2.2 – Added Codex plan conversion task, no-idle pivot guidance, and mandatory MCP transcript evidence per molecule
- 2025-10-18: Version 2.1 – Codex planning update and evidence execution focus
- 2025-10-17: Version 2.0 – Production QA scope + reporting
- 2025-10-16: Version 1.0 – Smoke/axe checklists
