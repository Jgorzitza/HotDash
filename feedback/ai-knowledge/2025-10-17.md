# AI-Knowledge — Feedback — 2025-10-17

## Status Summary
- Added `app/services/knowledge/ingestion.stub.ts` documenting pending decisions.
- Captured assumptions + contract test instructions in `docs/specs/knowledge_pipeline.md`.
- Waiting on manager-issued Issue/Allowed paths to proceed with production ingestion work.

## Evidence
```bash
node -e "import('./app/services/knowledge/ingestion.stub.ts').then(m => m.ingestKnowledgeStub().then(console.log))"
node -e "import('./app/services/knowledge/embeddings/openai.ts').then(m => m.generateEmbedding('hello world').then(v => console.log(v.length)))"
```
- Spec updated: see `docs/specs/knowledge_pipeline.md` for decision matrix and environment wiring.

## Blockers / Risks
1. Allowed paths + owner approvals for KB source directories.
2. Provision OpenAI embedding credentials (text-embedding-3-small) for ingestion pipeline.
3. Supabase service role credentials for knowledge tables.
4. HITL workflow definition for ingest approvals.

## Next Steps
- Integrate OpenAI client once credentials provided.
- Align with DevOps on Supabase role provisioning.
- Draft HITL ingestion approval runbook.


## Run Log (2025-10-17)
- Contract stub verification (TS via tsx):
  ```bash
  npx -y tsx -e "import('./app/services/knowledge/ingestion.stub.ts').then(m => m.ingestKnowledgeStub().then(console.log)))"
  ```
- Embeddings devFallback check (len 1536):
  ```bash
  npx -y tsx -e "import('./app/services/knowledge/embeddings/openai.ts').then(async m => { const v = await m.generateEmbedding('hello world', { devFallback: true }); console.log('len', v.length) })"
  ```
- Learning stub check:
  ```bash
  npx -y tsx -e "import('./app/services/knowledge/learning.ts').then(async m => { const res = await m.recordLearningStub({ suggestionId: 's-123', editor: 'justin@hotrodan.com', tone: 5, accuracy: 5, policy: 5, original: 'Hello', approved: 'Hello there', occurredAt: new Date().toISOString() }); console.log(res.status) })"
  ```
- Build/Drift stubs:
  ```bash
  npx -y tsx scripts/ai/build-llama-index.ts
  npx -y tsx scripts/ai/drift-check.ts
  ```
